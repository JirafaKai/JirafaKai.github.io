<!DOCTYPE HTML>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="zh-tw">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="author" content="JirafaKai">

	<link media="all" type="text/css" rel="stylesheet" href="main.css">
    <link media="all" type="text/css" rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link media="all" type="text/css" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
    
    <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<!--
Google spreadsheet = https://docs.google.com/spreadsheets/d/1osCn09v241irWHcW2t21XxVjv41sSRMdb5rCduNG24I/pubhtml
JSON = https://spreadsheets.google.com/feeds/list/1osCn09v241irWHcW2t21XxVjv41sSRMdb5rCduNG24I/od6/public/values?alt=json
-->

<body>
    <div class="container">
	<header id="banner" class="body">
	<!--navigation bar on the top><!-->
    	<nav>
        <ul>
           <li class="active"><a href="#">Test1</a></li>
           <li><a href="#">Test2</a></li>
        </ul>
	</nav>
	</header>
    </div>
	
	<!--Search Box in the middle><!-->
	<div id="search-box">
        <div class="container">
			<label for="inputKeyword" class="sr-only">關鍵字</label>
		    <input type="text" id="inputKeyword" class="form-control" placeholder="請輸入關鍵字 ex. 紅蓮、弓手、杖" required autofocus>
        </div>
	</div>
    <div class="container">	
	  <div id="charDiv">
			<div id="result">
				
			</div>
	  </div>
	</div>

	<div id="overlay-loading">
		<div id="overlay-loading-content">
			<i class="fa fa-spinner fa-pulse fa-4x"></i>
            <div>從 google spreadsheets 讀取問題資料（<span id="loaded-count"></span>）</div>
        </div>
    </div>

	
	<script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../bootstrap/twitter-bootstrap-v2/docs/assets/js/jquery.js"></script>
    <script type="text/javascript" src="../bootstrap/twitter-bootstrap-v2/docs/assets/js/bootstrap-collapse.js"></script>
	
	<script>
	var exeOrder = 0;
	var sheetId = '1osCn09v241irWHcW2t21XxVjv41sSRMdb5rCduNG24I';
	var finishCount = 0;
	var gridIds = {
		'charactor' : ['charactor', 'loadChar']
		//'weapon'	: ['weapon', 'loadWeapon']
	};
	
	var imgSrc = [];
	var charName = [];
    var charStar = [];
	var charType = [];
	var comment = [];
    var hp = [];
    var sp = [];
    var atk = [];
    var def = [];
    var cri = [];
	var ls1 = [];
	var ls2 = [];
    var as1 = [];
    var as2 = [];
    var ds = [];
    
	
	function testPrint(){
		$("#result").append(charName.length + '<br/>');
		for (var i=0; i<charName.length; i++){
			$("#result").append(charName[i] + charType[i] + '<br/>'); 
		}	
	}
	

	$(document).ready(
		function() {
	
		var urlScript = "https://spreadsheets.google.com/feeds/list/1osCn09v241irWHcW2t21XxVjv41sSRMdb5rCduNG24I/od6/public/values?alt=json";
		
		$.getJSON(urlScript, 
			function(JData){
				for (var i in JData.feed.entry){
					imgSrc[i] = JData.feed.entry[i].gsx$imgsrc.$t;
					charName[i] = JData.feed.entry[i].gsx$charname.$t;
                    charStar[i] = JData.feed.entry[i].gsx$charstar.$t;
					charType[i] = JData.feed.entry[i].gsx$chartype.$t;
                    hp[i] = JData.feed.entry[i].gsx$hp.$t;
                    sp[i] = JData.feed.entry[i].gsx$sp.$t;
                    atk[i] = JData.feed.entry[i].gsx$atk.$t;
                    def[i] = JData.feed.entry[i].gsx$def.$t;
                    cri[i] = JData.feed.entry[i].gsx$cri.$t;
					ls1[i] = JData.feed.entry[i].gsx$ls1.$t;
					ls2[i] = JData.feed.entry[i].gsx$ls2.$t;
					as1[i] = JData.feed.entry[i].gsx$as1.$t;
                    as2[i] = JData.feed.entry[i].gsx$as2.$t;
                    ds[i] = JData.feed.entry[i].gsx$ds.$t;
			}
			//testPrint();
			$("#overlay-loading").remove();
		});
		
		//$('form').on 'submit', -> console.log 'submit'; false
		
		var key = document.getElementById("inputKeyword");
		
		
		key.onkeyup = function(e){
			$("#result").html("");
			
			for (var i in charName){
			
				if (key.value.length <= 0) {
					return $("#result").html("");
				}
				
				if (charName[i].indexOf(key.value) !== -1) 
				{
					$("#result").append('<table class="table" id="charTable"><tr>'
										+ '<td id="imgtd"><img src="' + imgSrc[i] + '"></img></td>'
										+ '<td id="charNametd">' + charName[i] + '</td>'
                                        + '<td id="charStartd">' + charStar[i] + '</td>'
										+ '<td id="charTypetd">'+ charType[i] + '</td>'
                                        + '<td id="attrtd">LV.100</td>'
                                        + '<td id="attrtd">HP '+ hp[i] + '</td>'
                                        + '<td id="attrtd">SP '+ sp[i] + '</td>'
                                        + '<td id="attrtd">ATK '+ atk[i] + '</td>'
                                        + '<td id="attrtd">DEF '+ def[i] + '</td>'
                                        + '<td id="attrtd">CRI '+ cri[i] + '</td>'
                                        + '<td id="more"><a href="#char' + i + ' "data-toggle="collapse">更多</a></td>'
										+ '</tr></table>');
                    $("#result").append('<div id="char' + i + '" class="collapse">'
                                        + '<table class="table" id="skillTable"><tr>'
										+ '<tr><td id="titletd">隊長技能1</td><td>' + ls1[i] + '</td></tr>'
										+ '<tr><td id="titletd">隊長技能2</td><td>' + ls2[i] + '</td></tr>'
                                        + '<tr><td id="titletd">主動技能1</td><td>' + as1[i] + '</td></tr>'
                                        + '<tr><td id="titletd">主動技能2</td><td>' + as2[i] + '</td></tr>'
                                        + '<tr><td id="titletd">被動技能</td><td>' + ds[i] + '</td></tr>'
                                        + '</tr></td></table></div>');
				}
			}	
		};
		
	});
	</script>


</body>
</html>
